/*! @name aes-decrypter @version 3.1.0 @license Apache-2.0 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).aesDecrypter={})}(this,function(t){"use strict";function e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var r=function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t},n=function(){var t,e,r,n,i,s,o,u,c=[[[],[],[],[],[]],[[],[],[],[],[]]],l=c[0],f=c[1],a=l[4],h=f[4],y=[],p=[];for(t=0;t<256;t++)p[(y[t]=t<<1^283*(t>>7))^t]=t;for(e=r=0;!a[e];e^=n||1,r=p[r]||1)for(s=(s=r^r<<1^r<<2^r<<3^r<<4)>>8^255&s^99,a[e]=s,h[s]=e,u=16843009*y[i=y[n=y[e]]]^65537*i^257*n^16843008*e,o=257*y[s]^16843008*s,t=0;t<4;t++)l[t][e]=o=o<<24^o>>>8,f[t][s]=u=u<<24^u>>>8;for(t=0;t<5;t++)l[t]=l[t].slice(0),f[t]=f[t].slice(0);return c},i=null,s=function(){function t(t){var e,r,s;i||(i=n()),this._tables=[[i[0][0].slice(),i[0][1].slice(),i[0][2].slice(),i[0][3].slice(),i[0][4].slice()],[i[1][0].slice(),i[1][1].slice(),i[1][2].slice(),i[1][3].slice(),i[1][4].slice()]];var o=this._tables[0][4],u=this._tables[1],c=t.length,l=1;if(4!==c&&6!==c&&8!==c)throw new Error("Invalid aes key size");var f=t.slice(0),a=[];for(this._key=[f,a],e=c;e<4*c+28;e++)s=f[e-1],(e%c==0||8===c&&e%c==4)&&(s=o[s>>>24]<<24^o[s>>16&255]<<16^o[s>>8&255]<<8^o[255&s],e%c==0&&(s=s<<8^s>>>24^l<<24,l=l<<1^283*(l>>7))),f[e]=f[e-c]^s;for(r=0;e;r++,e--)s=f[3&r?e:e-4],a[r]=e<=4||r<4?s:u[0][o[s>>>24]]^u[1][o[s>>16&255]]^u[2][o[s>>8&255]]^u[3][o[255&s]]}return t.prototype.decrypt=function(t,e,r,n,i,s){var o,u,c,l,f=this._key[1],a=t^f[0],h=n^f[1],y=r^f[2],p=e^f[3],b=f.length/4-2,_=4,d=this._tables[1],v=d[0],g=d[1],m=d[2],w=d[3],A=d[4];for(l=0;l<b;l++)o=v[a>>>24]^g[h>>16&255]^m[y>>8&255]^w[255&p]^f[_],u=v[h>>>24]^g[y>>16&255]^m[p>>8&255]^w[255&a]^f[_+1],c=v[y>>>24]^g[p>>16&255]^m[a>>8&255]^w[255&h]^f[_+2],p=v[p>>>24]^g[a>>16&255]^m[h>>8&255]^w[255&y]^f[_+3],_+=4,a=o,h=u,y=c;for(l=0;l<4;l++)i[(3&-l)+s]=A[a>>>24]<<24^A[h>>16&255]<<16^A[y>>8&255]<<8^A[255&p]^f[_++],o=a,a=h,h=y,y=p,p=o},t}();var o=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e},u=function(){function t(){this.listeners={}}var e=t.prototype;return e.on=function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)},e.off=function(t,e){if(!this.listeners[t])return!1;var r=this.listeners[t].indexOf(e);return this.listeners[t]=this.listeners[t].slice(0),this.listeners[t].splice(r,1),r>-1},e.trigger=function(t){var e=this.listeners[t];if(e)if(2===arguments.length)for(var r=e.length,n=0;n<r;++n)e[n].call(this,arguments[1]);else for(var i=Array.prototype.slice.call(arguments,1),s=e.length,o=0;o<s;++o)e[o].apply(this,i)},e.dispose=function(){this.listeners={}},e.pipe=function(t){this.on("data",function(e){t.push(e)})},t}(),c=function(t){function e(){var e;return(e=t.call(this,u)||this).jobs=[],e.delay=1,e.timeout_=null,e}o(e,t);var r=e.prototype;return r.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},r.push=function(t){this.jobs.push(t),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},e}(u);
/*! @name @videojs/vhs-utils @version 2.2.1 @license MIT */var l=function(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24},f=function(t,e,r){var n,i,o,u,c,f,a,h,y,p=new Int32Array(t.buffer,t.byteOffset,t.byteLength>>2),b=new s(Array.prototype.slice.call(e)),_=new Uint8Array(t.byteLength),d=new Int32Array(_.buffer);for(n=r[0],i=r[1],o=r[2],u=r[3],y=0;y<p.length;y+=4)c=l(p[y]),f=l(p[y+1]),a=l(p[y+2]),h=l(p[y+3]),b.decrypt(c,f,a,h,d,y),d[y]=l(d[y]^n),d[y+1]=l(d[y+1]^i),d[y+2]=l(d[y+2]^o),d[y+3]=l(d[y+3]^u),n=c,i=f,o=a,u=h;return _},a=function(){function t(e,r,n,i){var s=t.STEP,o=new Int32Array(e.buffer),u=new Uint8Array(e.byteLength),f=0;for(this.asyncStream_=new c,this.asyncStream_.push(this.decryptChunk_(o.subarray(f,f+s),r,n,u)),f=s;f<o.length;f+=s)n=new Uint32Array([l(o[f-4]),l(o[f-3]),l(o[f-2]),l(o[f-1])]),this.asyncStream_.push(this.decryptChunk_(o.subarray(f,f+s),r,n,u));this.asyncStream_.push(function(){
/*! @name pkcs7 @version 1.0.4 @license Apache-2.0 */
var t;i(null,(t=u).subarray(0,t.byteLength-t[t.byteLength-1]))})}return t.prototype.decryptChunk_=function(t,e,r,n){return function(){var i=f(t,e,r);n.set(i,t.byteOffset)}},r(t,null,[{key:"STEP",get:function(){return 32e3}}]),t}();t.AsyncStream=c,t.Decrypter=a,t.decrypt=f,Object.defineProperty(t,"__esModule",{value:!0})});
